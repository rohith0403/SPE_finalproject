{"ast":null,"code":"const path = require('path');\n\nconst debug = require('debug')('log4js:appenders');\n\nconst configuration = require('../configuration');\n\nconst clustering = require('../clustering');\n\nconst levels = require('../levels');\n\nconst layouts = require('../layouts');\n\nconst adapters = require('./adapters'); // pre-load the core appenders so that webpack can find them\n\n\nconst coreAppenders = new Map();\ncoreAppenders.set('console', require('./console'));\ncoreAppenders.set('stdout', require('./stdout'));\ncoreAppenders.set('stderr', require('./stderr'));\ncoreAppenders.set('logLevelFilter', require('./logLevelFilter'));\ncoreAppenders.set('categoryFilter', require('./categoryFilter'));\ncoreAppenders.set('noLogFilter', require('./noLogFilter'));\ncoreAppenders.set('file', require('./file'));\ncoreAppenders.set('dateFile', require('./dateFile'));\ncoreAppenders.set('fileSync', require('./fileSync'));\nconst appenders = new Map();\n\nconst tryLoading = (modulePath, config) => {\n  debug('Loading module from ', modulePath);\n\n  try {\n    return require(modulePath); //eslint-disable-line\n  } catch (e) {\n    // if the module was found, and we still got an error, then raise it\n    configuration.throwExceptionIf(config, e.code !== 'MODULE_NOT_FOUND', `appender \"${modulePath}\" could not be loaded (error was: ${e})`);\n    return undefined;\n  }\n};\n\nconst loadAppenderModule = (type, config) => coreAppenders.get(type) || tryLoading(`./${type}`, config) || tryLoading(type, config) || require.main && tryLoading(path.join(path.dirname(require.main.filename), type), config) || tryLoading(path.join(process.cwd(), type), config);\n\nconst appendersLoading = new Set();\n\nconst getAppender = (name, config) => {\n  if (appenders.has(name)) return appenders.get(name);\n  if (!config.appenders[name]) return false;\n  if (appendersLoading.has(name)) throw new Error(`Dependency loop detected for appender ${name}.`);\n  appendersLoading.add(name);\n  debug(`Creating appender ${name}`); // eslint-disable-next-line no-use-before-define\n\n  const appender = createAppender(name, config);\n  appendersLoading.delete(name);\n  appenders.set(name, appender);\n  return appender;\n};\n\nconst createAppender = (name, config) => {\n  const appenderConfig = config.appenders[name];\n  const appenderModule = appenderConfig.type.configure ? appenderConfig.type : loadAppenderModule(appenderConfig.type, config);\n  configuration.throwExceptionIf(config, configuration.not(appenderModule), `appender \"${name}\" is not valid (type \"${appenderConfig.type}\" could not be found)`);\n\n  if (appenderModule.appender) {\n    debug(`DEPRECATION: Appender ${appenderConfig.type} exports an appender function.`);\n  }\n\n  if (appenderModule.shutdown) {\n    debug(`DEPRECATION: Appender ${appenderConfig.type} exports a shutdown function.`);\n  }\n\n  debug(`${name}: clustering.isMaster ? ${clustering.isMaster()}`);\n  debug(`${name}: appenderModule is ${require('util').inspect(appenderModule)}`); // eslint-disable-line\n\n  return clustering.onlyOnMaster(() => {\n    debug(`calling appenderModule.configure for ${name} / ${appenderConfig.type}`);\n    return appenderModule.configure(adapters.modifyConfig(appenderConfig), layouts, appender => getAppender(appender, config), levels);\n  }, () => {});\n};\n\nconst setup = config => {\n  appenders.clear();\n  appendersLoading.clear();\n  const usedAppenders = [];\n  Object.values(config.categories).forEach(category => {\n    usedAppenders.push(...category.appenders);\n  });\n  Object.keys(config.appenders).forEach(name => {\n    // dodgy hard-coding of special case for tcp-server which may not have\n    // any categories associated with it, but needs to be started up anyway\n    if (usedAppenders.includes(name) || config.appenders[name].type === 'tcp-server') {\n      getAppender(name, config);\n    }\n  });\n};\n\nsetup({\n  appenders: {\n    out: {\n      type: 'stdout'\n    }\n  },\n  categories: {\n    default: {\n      appenders: ['out'],\n      level: 'trace'\n    }\n  }\n});\nconfiguration.addListener(config => {\n  configuration.throwExceptionIf(config, configuration.not(configuration.anObject(config.appenders)), 'must have a property \"appenders\" of type object.');\n  const appenderNames = Object.keys(config.appenders);\n  configuration.throwExceptionIf(config, configuration.not(appenderNames.length), 'must define at least one appender.');\n  appenderNames.forEach(name => {\n    configuration.throwExceptionIf(config, configuration.not(config.appenders[name].type), `appender \"${name}\" is not valid (must be an object with property \"type\")`);\n  });\n});\nconfiguration.addListener(setup);\nmodule.exports = appenders;","map":{"version":3,"sources":["/Users/osurihimeshkrishna/Downloads/Academics/8th Semester/Software Production Engineering/spe_finalproject/my-app/node_modules/log4js/lib/appenders/index.js"],"names":["path","require","debug","configuration","clustering","levels","layouts","adapters","coreAppenders","Map","set","appenders","tryLoading","modulePath","config","e","throwExceptionIf","code","undefined","loadAppenderModule","type","get","main","join","dirname","filename","process","cwd","appendersLoading","Set","getAppender","name","has","Error","add","appender","createAppender","delete","appenderConfig","appenderModule","configure","not","shutdown","isMaster","inspect","onlyOnMaster","modifyConfig","setup","clear","usedAppenders","Object","values","categories","forEach","category","push","keys","includes","out","default","level","addListener","anObject","appenderNames","length","module","exports"],"mappings":"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","sourcesContent":["const path = require('path');\nconst debug = require('debug')('log4js:appenders');\nconst configuration = require('../configuration');\nconst clustering = require('../clustering');\nconst levels = require('../levels');\nconst layouts = require('../layouts');\nconst adapters = require('./adapters');\n\n// pre-load the core appenders so that webpack can find them\nconst coreAppenders = new Map();\ncoreAppenders.set('console', require('./console'));\ncoreAppenders.set('stdout', require('./stdout'));\ncoreAppenders.set('stderr', require('./stderr'));\ncoreAppenders.set('logLevelFilter', require('./logLevelFilter'));\ncoreAppenders.set('categoryFilter', require('./categoryFilter'));\ncoreAppenders.set('noLogFilter', require('./noLogFilter'));\ncoreAppenders.set('file', require('./file'));\ncoreAppenders.set('dateFile', require('./dateFile'));\ncoreAppenders.set('fileSync', require('./fileSync'));\n\nconst appenders = new Map();\n\nconst tryLoading = (modulePath, config) => {\n  debug('Loading module from ', modulePath);\n  try {\n    return require(modulePath); //eslint-disable-line\n  } catch (e) {\n    // if the module was found, and we still got an error, then raise it\n    configuration.throwExceptionIf(\n      config,\n      e.code !== 'MODULE_NOT_FOUND',\n      `appender \"${modulePath}\" could not be loaded (error was: ${e})`\n    );\n    return undefined;\n  }\n};\n\nconst loadAppenderModule = (type, config) => coreAppenders.get(type)\n  || tryLoading(`./${type}`, config)\n  || tryLoading(type, config)\n  || (require.main && tryLoading(path.join(path.dirname(require.main.filename), type), config))\n  || tryLoading(path.join(process.cwd(), type), config);\n\nconst appendersLoading = new Set();\n\nconst getAppender = (name, config) => {\n  if (appenders.has(name)) return appenders.get(name);\n  if (!config.appenders[name]) return false;\n  if (appendersLoading.has(name)) throw new Error(`Dependency loop detected for appender ${name}.`);\n  appendersLoading.add(name);\n\n  debug(`Creating appender ${name}`);\n  // eslint-disable-next-line no-use-before-define\n  const appender = createAppender(name, config);\n  appendersLoading.delete(name);\n  appenders.set(name, appender);\n  return appender;\n};\n\nconst createAppender = (name, config) => {\n  const appenderConfig = config.appenders[name];\n  const appenderModule = appenderConfig.type.configure\n    ? appenderConfig.type : loadAppenderModule(appenderConfig.type, config);\n  configuration.throwExceptionIf(\n    config,\n    configuration.not(appenderModule),\n    `appender \"${name}\" is not valid (type \"${appenderConfig.type}\" could not be found)`\n  );\n  if (appenderModule.appender) {\n    debug(`DEPRECATION: Appender ${appenderConfig.type} exports an appender function.`);\n  }\n  if (appenderModule.shutdown) {\n    debug(`DEPRECATION: Appender ${appenderConfig.type} exports a shutdown function.`);\n  }\n\n  debug(`${name}: clustering.isMaster ? ${clustering.isMaster()}`);\n  debug(`${name}: appenderModule is ${require('util').inspect(appenderModule)}`); // eslint-disable-line\n  return clustering.onlyOnMaster(() => {\n    debug(`calling appenderModule.configure for ${name} / ${appenderConfig.type}`);\n    return appenderModule.configure(\n      adapters.modifyConfig(appenderConfig),\n      layouts,\n      appender => getAppender(appender, config),\n      levels\n    );\n  }, () => { });\n};\n\nconst setup = (config) => {\n  appenders.clear();\n  appendersLoading.clear();\n  const usedAppenders = [];\n  Object.values(config.categories).forEach(category => {\n    usedAppenders.push(...category.appenders)\n  });\n  Object.keys(config.appenders).forEach((name) => {\n    // dodgy hard-coding of special case for tcp-server which may not have\n    // any categories associated with it, but needs to be started up anyway\n    if (usedAppenders.includes(name) || config.appenders[name].type === 'tcp-server') {\n      getAppender(name, config);\n    }\n  });\n};\n\nsetup({ appenders: { out: { type: 'stdout' } }, categories: { default: { appenders: ['out'], level: 'trace' } } });\n\nconfiguration.addListener((config) => {\n  configuration.throwExceptionIf(\n    config,\n    configuration.not(configuration.anObject(config.appenders)),\n    'must have a property \"appenders\" of type object.'\n  );\n  const appenderNames = Object.keys(config.appenders);\n  configuration.throwExceptionIf(\n    config,\n    configuration.not(appenderNames.length),\n    'must define at least one appender.'\n  );\n\n  appenderNames.forEach((name) => {\n    configuration.throwExceptionIf(\n      config,\n      configuration.not(config.appenders[name].type),\n      `appender \"${name}\" is not valid (must be an object with property \"type\")`\n    );\n  });\n});\n\nconfiguration.addListener(setup);\n\nmodule.exports = appenders;\n"]},"metadata":{},"sourceType":"script"}